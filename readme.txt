# SamReader
**Authors:** Lucien Maurau, Mathilde Chatain  
**Contacts:** lucien.maurau@etu.umontpellier.fr, mathilde.chatain@etu.umontpellier.fr  

---

## Description

`SamReader.py` is a Python script designed to analyze **SAM (Sequence Alignment/Map)** files generated by **samtools**.  

The script performs the following tasks:  

- Verifies the integrity of the SAM file.  
- Filters reads based on a **minimum quality threshold**.  
- Categorizes reads as **unmapped**, **partially mapped**, or **perfectly mapped**.  
- Handles **paired-end reads**.  
- Parses **CIGAR strings** to compute mutation percentages.  
- Generates multiple output files for downstream analysis.  

---

## Features

1. **SAM file verification**
   - Checks if the file exists
   - Ensures the file is not empty
2. Filters reads by mapping quality
3. Identifies:
   - Unmapped reads
   - Partially mapped reads
   - Perfectly mapped reads
4. Handles paired-end reads
5. Parses and summarizes CIGAR strings
6. Computes mutation percentages per read and globally
7. Generates summary and FASTA output files

---

## Requirements

- Python 3.x  
- Standard Python modules: `os`, `sys`, `re`, `itertools`  

---

## Input

- A **SAM file** (`.sam`) produced by `samtools`.  
- A **minimum quality value** for filtering reads.  

---

## Usage

```bash
python3 SamReader.py <input.sam> <min_quality>

Note : The command must be executed in the directory containing the Script, and the script must be contained in a similar directory than in this git depot (the paths to store the results are buit-in).  